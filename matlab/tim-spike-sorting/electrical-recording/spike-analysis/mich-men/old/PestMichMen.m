function [rspont,rinf,koff,kon,tdelay] = PestMichMen(spikes,trange,ton)nexp = length(spikes);npb = zeros(3,nexp);tdelay = 0.5;for i = 1:nexp	nrpts(i) = length(spikes{i});	allspikes{i} = sort(cat(2,spikes{i}{:}));	npb(:,i) = HistSplit(allspikes{i},[0 ton]+tdelay)'/nrpts(i);end% Estimate the spontanteous raterspont = mean(npb(1,:))/abs(trange(1));% Estimate the steady-state rate for each exptrss = npb(2,:)/ton;% Estimate the max rate (just make it constant)rinf = max([15 rss]);% Now use this to estimate:%	(1) the off rate (const across experiments)num = 0;denom = 0;for i = 1:nexp	indx = find(allspikes{i} > ton+tdelay);	num = num + nrpts(i)*rss(i);	denom = denom + sum(allspikes{i}(indx)-(ton+tdelay));endkoff = num/denom;%	(2) the on raternorm = rss/rinf;kon = koff*rnorm./(1.1-rnorm);	% 1.1 to prevent div. by zero