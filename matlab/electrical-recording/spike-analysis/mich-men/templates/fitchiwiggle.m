for i = 1:32	%[tsplit{i},mn{i},err{i},sk{i}] = SplitGauss(zspike{i},0.3);	[tsplit{i},mn{i},err{i},sk{i}] = SplitGauss(zspike{i},0.4);endkeep = zeros(1,32);for i = 1:32	%if (length(sk{i}) > 1 | sk{i}(1) < 0.3), keep(i) = 1; end;	if (length(sk{i}) > 1 | sk{i}(1) < 0.4), keep(i) = 1; end;end;%pstart = pblin(:,cl);[pbest,chi2,dof,C] = FitPSTRateChi(tsplit,mn,err,keep,tr,pvarstart,varloc,pfix,fixloc,nparms,ifunc,pcheckfunc);if (chi2 < 0)	pbst = pbest;	chi2s = chi2;	return;endnwig = 20;ps = repmat(pbest,1,nwig); ps = ps.*(0.5+rand(size(ps)));[ok,badindx] = feval(pcheckfunc,ps);goodindx = setdiff(1:nwig,badindx);pbst = []; chi2s = [];for i = 1:length(goodindx);	[pbst(:,i),chi2s(i)] = FitPSTRateChi(tsplit,mn,err,keep,tr,ps(:,goodindx(i)),varloc,pfix,fixloc,nparms,ifunc,pcheckfunc);endpbst(:,end+1) = pbest;chi2s(end+1) = chi2;[chi2s,sindx] = sort(chi2s);pbst = pbst(:,sindx);
