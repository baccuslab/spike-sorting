function irate = IntRateMichMen(trange,p)trange = trange-p(6);	% time delaytl = [min(trange(1),0),min(trange(2),0)];tm = [min(p(5),max(0,trange(1))),min(p(5),max(0,trange(2)))];tr = [max(p(5),trange(1)),max(p(5),trange(2))];irate = (tl(2)-tl(1))*p(1);sumk = p(3)+p(4);irate = irate + p(2)*p(3)/sumk*(tm(2)-tm(1)+(exp(-sumk*tm(2))-exp(-sumk*tm(1)))/sumk) + p(1)*(tm(2)-tm(1));rAtOff = p(2)*p(3)/(p(3)+p(4)) * (1-exp(-(p(3)+p(4))*p(5)));irate = irate - rAtOff*(exp(-p(4)*(tr(2)-p(5))) - exp(-p(4)*(tr(1)-p(5))))/p(4) + p(1)*(tr(2)-tr(1));return;
