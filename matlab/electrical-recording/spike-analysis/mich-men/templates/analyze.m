[rec,recfiles,cells,chandef] = ConvertToCell(':::stimtimes.vlv','sort1');trange = [-5 10];dorec = [2:9];%dorec = [5:9];%'Warning: truncated for cell 23 analysis!'[stim,spike] = CollectResponses(rec(dorec),trange);[ustim,uspike] = UnifyRecords(stim,spike);%for i = 1:length(recfiles); h = ReadSnipHeader([recfiles{i},'.ssnp']); [stimtxt{i},vlabel{i}] = ParseUsrHdr(h.usrhdr); endcvlabel = {'Ringer''s','KCl 50mM','Female/1000','Female/300','Female/100','Female/30','Male/1000','Male/300','Male/100','Male/30'};st = 2:11;cl = 23; figure; PlotResponses(ustim(st),uspike(st,cl),cvlabel(st-1)); suptitle(sprintf('Cell %d',cl))%cl = 11; for fl = 1:6; figure; PlotResponses(stim(fl,:),spike(fl,:,cl),vlabel{dorec(fl)}); suptitle(sprintf('Cell %d',cl)); end[ton,spikediff] = RateChange(ustim,uspike,trange);[tmom,n,mnmom,sigmom] = MomentsRateChange(ton,spikediff);% figure; st = 7:10; cl = 1:23; PlotMeanRateChange(tmom(st),n(st),mnmom(st,cl),sigmom(st,cl),cvlabel(st-1),cl)tint = round(ton{3}*10)/10;utint = unique(tint);for i = 1:length(utint)	ti{i} = find(tint == utint(i));endfor st = 2:11; cl = 17; for i = 1:4, [r(st-1,i,:),tpsth] = PSTH(ustim{st}(ti{i}),uspike{st,cl}(ti{i}),0.25); end; endtpsth = tpsth - 5;%nst = 2; figure; plot(tpsth,squeeze(r(nst,:,:))); title(cvlabel{nst}); xlabel('Time (s)'); ylabel('Firing rate (Hz)')figurenst = 2; subplot(2,2,1); plot(tpsth,squeeze(r(nst,:,:))); title(cvlabel{nst}); xlabel('Time (s)'); ylabel('Firing rate (Hz)')nst = 5; subplot(2,2,2); plot(tpsth,squeeze(r(nst,:,:))); title(cvlabel{nst}); xlabel('Time (s)'); ylabel('Firing rate (Hz)')nst = 9; subplot(2,2,3); plot(tpsth,squeeze(r(nst,:,:))); title(cvlabel{nst}); xlabel('Time (s)'); ylabel('Firing rate (Hz)')subplot(2,2,4); plot(tpsth,squeeze(r([2 9],1,:)));title('0.5s pulse')xlabel('Time (s)')legend(cvlabel{2},cvlabel{9})subplot(2,2,1)legend('0.5s','1s','2s','4s')subplot(2,2,3)suptitle('Cell 17')timelabel = {'0.5s','1s','2s','4s'};